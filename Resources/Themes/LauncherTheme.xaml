<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">

    <!-- converters -->
    <BooleanToVisibilityConverter x:Key="BoolToVis"/>

    <!-- =========================
         PALETTE (cosmic purple)
         ========================= -->
    <Color x:Key="C_Bg0">#070815</Color>
    <Color x:Key="C_Bg1">#0B0F1A</Color>
    <Color x:Key="C_Surface">#121228</Color>

    <Color x:Key="C_Stroke">#2A3550</Color>
    <Color x:Key="C_StrokeSoft">#1F2A44</Color>

    <Color x:Key="C_TextStrong">#EAF0FF</Color>
    <Color x:Key="C_TextDim">#AAB4C5</Color>

    <Color x:Key="C_Accent">#7C3AED</Color>
    <Color x:Key="C_Accent2">#A855F7</Color>
    <Color x:Key="C_Accent3">#B86BFF</Color>

    <SolidColorBrush x:Key="Bg0" Color="{StaticResource C_Bg0}"/>
    <SolidColorBrush x:Key="Bg1" Color="{StaticResource C_Bg1}"/>
    <SolidColorBrush x:Key="Surface" Color="{StaticResource C_Surface}"/>

    <SolidColorBrush x:Key="Stroke" Color="{StaticResource C_Stroke}"/>
    <SolidColorBrush x:Key="StrokeSoft" Color="{StaticResource C_StrokeSoft}"/>

    <SolidColorBrush x:Key="TextStrong" Color="{StaticResource C_TextStrong}"/>
    <SolidColorBrush x:Key="TextDim" Color="{StaticResource C_TextDim}"/>

    <SolidColorBrush x:Key="Accent" Color="{StaticResource C_Accent}"/>
    <SolidColorBrush x:Key="Accent2" Color="{StaticResource C_Accent2}"/>

    <!-- “светящаяся” обводка -->
    <LinearGradientBrush x:Key="StrokeGlow" StartPoint="0,0" EndPoint="1,1">
        <GradientStop Color="#40A855F7" Offset="0"/>
        <GradientStop Color="#809B5CFF" Offset="0.45"/>
        <GradientStop Color="#307C3AED" Offset="1"/>
    </LinearGradientBrush>

    <LinearGradientBrush x:Key="PrimaryGlow" StartPoint="0,0" EndPoint="1,0">
        <GradientStop Color="#B07C3AED" Offset="0"/>
        <GradientStop Color="#C0A855F7" Offset="0.55"/>
        <GradientStop Color="#B0B86BFF" Offset="1"/>
    </LinearGradientBrush>

    <!-- translucent surfaces -->
    <SolidColorBrush x:Key="GlassPanel">
        <SolidColorBrush.Color>#101223</SolidColorBrush.Color>
        <SolidColorBrush.Opacity>0.62</SolidColorBrush.Opacity>
    </SolidColorBrush>

    <SolidColorBrush x:Key="FieldGlass">
        <SolidColorBrush.Color>#0B0F1A</SolidColorBrush.Color>
        <SolidColorBrush.Opacity>0.55</SolidColorBrush.Opacity>
    </SolidColorBrush>

    <!-- =========================
         EFFECTS
         ========================= -->
    <DropShadowEffect x:Key="ShadowSoft" BlurRadius="22" ShadowDepth="6" Opacity="0.28" Color="#000000"/>
    <DropShadowEffect x:Key="ShadowCard" BlurRadius="18" ShadowDepth="4" Opacity="0.22" Color="#000000"/>
    <DropShadowEffect x:Key="ShadowAccent" BlurRadius="28" ShadowDepth="0" Opacity="0.35" Color="#A855F7"/>
    <DropShadowEffect x:Key="ShadowAccentStrong" BlurRadius="34" ShadowDepth="0" Opacity="0.45" Color="#7C3AED"/>

    <!-- =========================
         GLOBAL TEXT
         ========================= -->
    <Style TargetType="TextBlock">
        <Setter Property="TextWrapping" Value="Wrap"/>
    </Style>

    <!-- =========================
         ROOT / FRAMES
         ========================= -->
    <Style x:Key="RootBorderStyle" TargetType="Border">
        <Setter Property="CornerRadius" Value="16"/>
        <Setter Property="Background" Value="{StaticResource Bg1}"/>
        <Style.Triggers>
            <DataTrigger Binding="{Binding WindowState, RelativeSource={RelativeSource AncestorType=Window}}" Value="Maximized">
                <Setter Property="CornerRadius" Value="0"/>
            </DataTrigger>
        </Style.Triggers>
    </Style>

    <Style x:Key="TopBarStyle" TargetType="Border">
        <Setter Property="Background" Value="{StaticResource GlassPanel}"/>
        <Setter Property="BorderBrush" Value="{StaticResource StrokeGlow}"/>
        <Setter Property="BorderThickness" Value="1"/>
        <Setter Property="CornerRadius" Value="16"/>
        <Setter Property="Padding" Value="14,8"/>
        <Setter Property="Effect" Value="{StaticResource ShadowSoft}"/>
    </Style>

    <Style x:Key="ScreenFrameStyle" TargetType="Border">
        <Setter Property="Background" Value="#00000000"/>
        <Setter Property="BorderBrush" Value="{StaticResource StrokeGlow}"/>
        <Setter Property="BorderThickness" Value="1"/>
        <Setter Property="CornerRadius" Value="20"/>
        <Setter Property="ClipToBounds" Value="True"/>
        <Setter Property="Effect" Value="{StaticResource ShadowAccent}"/>
    </Style>

    <Style x:Key="HiddenTabsStyle" TargetType="{x:Type TabControl}">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type TabControl}">
                    <ContentPresenter ContentSource="SelectedContent"/>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- =========================
         CARDS / FIELDS
         ========================= -->
    <Style x:Key="CardStyle" TargetType="Border">
        <Setter Property="Background" Value="{StaticResource GlassPanel}"/>
        <Setter Property="BorderBrush" Value="{StaticResource StrokeGlow}"/>
        <Setter Property="BorderThickness" Value="1"/>
        <Setter Property="CornerRadius" Value="18"/>
        <Setter Property="Padding" Value="18"/>
        <Setter Property="Effect" Value="{StaticResource ShadowCard}"/>
        <Setter Property="SnapsToDevicePixels" Value="True"/>
    </Style>

    <Style x:Key="FieldCardStyle" TargetType="Border" BasedOn="{StaticResource CardStyle}">
        <Setter Property="CornerRadius" Value="18"/>
        <Setter Property="Padding" Value="16"/>
        <Setter Property="Background" Value="{StaticResource FieldGlass}"/>
        <Setter Property="Effect" Value="{StaticResource ShadowAccent}"/>
    </Style>

    <Style x:Key="StatusStripStyle" TargetType="Border">
        <Setter Property="Background" Value="#15172B"/>
        <Setter Property="BorderBrush" Value="{StaticResource StrokeGlow}"/>
        <Setter Property="BorderThickness" Value="1"/>
        <Setter Property="CornerRadius" Value="12"/>
        <Setter Property="Padding" Value="12,10"/>
        <Setter Property="Margin" Value="0,12,0,0"/>
    </Style>

    <!-- =========================
         BUTTONS
         ========================= -->
    <Style x:Key="BaseButton" TargetType="Button">
        <Setter Property="Foreground" Value="{StaticResource TextStrong}"/>
        <Setter Property="BorderThickness" Value="1"/>
        <Setter Property="Padding" Value="18,12"/>
        <Setter Property="Cursor" Value="Hand"/>
        <Setter Property="FontWeight" Value="SemiBold"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="Button">
                    <Border x:Name="bd"
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            CornerRadius="14">
                        <ContentPresenter HorizontalAlignment="Center"
                                          VerticalAlignment="Center"
                                          Margin="{TemplateBinding Padding}"/>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="bd" Property="Opacity" Value="0.97"/>
                            <Setter TargetName="bd" Property="Effect" Value="{StaticResource ShadowAccent}"/>
                        </Trigger>
                        <Trigger Property="IsPressed" Value="True">
                            <Setter TargetName="bd" Property="Opacity" Value="0.88"/>
                        </Trigger>
                        <Trigger Property="IsEnabled" Value="False">
                            <Setter TargetName="bd" Property="Opacity" Value="0.45"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="PrimaryButton" TargetType="Button" BasedOn="{StaticResource BaseButton}">
        <Setter Property="Background" Value="{StaticResource PrimaryGlow}"/>
        <Setter Property="BorderBrush" Value="{StaticResource StrokeGlow}"/>
    </Style>

    <Style x:Key="GhostButton" TargetType="Button" BasedOn="{StaticResource BaseButton}">
        <Setter Property="Background" Value="#00000000"/>
        <Setter Property="BorderBrush" Value="{StaticResource StrokeGlow}"/>
    </Style>

    <Style x:Key="DangerButton" TargetType="Button" BasedOn="{StaticResource BaseButton}">
        <Setter Property="Background" Value="#2A1020"/>
        <Setter Property="BorderBrush" Value="#6B1D3A"/>
        <Setter Property="Foreground" Value="#FFD6E3"/>
    </Style>

    <Style x:Key="WinCtlButton" TargetType="Button">
        <Setter Property="Width" Value="42"/>
        <Setter Property="Height" Value="32"/>
        <Setter Property="Padding" Value="0"/>
        <Setter Property="Background" Value="#00000000"/>
        <Setter Property="BorderBrush" Value="#00000000"/>
        <Setter Property="Foreground" Value="#DCE5FF"/>
        <Setter Property="Cursor" Value="Hand"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="Button">
                    <Border x:Name="bd" CornerRadius="12" Background="{TemplateBinding Background}">
                        <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="bd" Property="Background" Value="#24FFFFFF"/>
                        </Trigger>
                        <Trigger Property="IsPressed" Value="True">
                            <Setter TargetName="bd" Property="Background" Value="#32FFFFFF"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="ProfileButton" TargetType="Button">
        <Setter Property="Height" Value="36"/>
        <Setter Property="Padding" Value="12,7"/>
        <Setter Property="Background" Value="{StaticResource GlassPanel}"/>
        <Setter Property="BorderBrush" Value="{StaticResource StrokeGlow}"/>
        <Setter Property="BorderThickness" Value="1"/>
        <Setter Property="Foreground" Value="{StaticResource TextStrong}"/>
        <Setter Property="Cursor" Value="Hand"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="Button">
                    <Border x:Name="bd"
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            CornerRadius="14">
                        <ContentPresenter Margin="{TemplateBinding Padding}"
                                          HorizontalAlignment="Center"
                                          VerticalAlignment="Center"/>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="bd" Property="Opacity" Value="0.98"/>
                            <Setter TargetName="bd" Property="Effect" Value="{StaticResource ShadowAccent}"/>
                        </Trigger>
                        <Trigger Property="IsPressed" Value="True">
                            <Setter TargetName="bd" Property="Opacity" Value="0.90"/>
                        </Trigger>
                        <Trigger Property="IsEnabled" Value="False">
                            <Setter TargetName="bd" Property="Opacity" Value="0.50"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- =========================
         TEXTBOX (glow focus)
         ========================= -->
    <Style TargetType="TextBox">
        <Setter Property="Background" Value="#101329"/>
        <Setter Property="BorderBrush" Value="{StaticResource StrokeGlow}"/>
        <Setter Property="Foreground" Value="{StaticResource TextStrong}"/>
        <Setter Property="BorderThickness" Value="1"/>
        <Setter Property="Padding" Value="14,10"/>
        <Setter Property="Height" Value="42"/>
        <Setter Property="CaretBrush" Value="{StaticResource TextStrong}"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="TextBox">
                    <Border x:Name="bd"
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            CornerRadius="14">
                        <ScrollViewer x:Name="PART_ContentHost" Margin="0"/>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="bd" Property="Background" Value="#141A36"/>
                        </Trigger>
                        <Trigger Property="IsKeyboardFocused" Value="True">
                            <Setter TargetName="bd" Property="BorderBrush" Value="{StaticResource Accent2}"/>
                            <Setter TargetName="bd" Property="Effect" Value="{StaticResource ShadowAccentStrong}"/>
                        </Trigger>
                        <Trigger Property="IsEnabled" Value="False">
                            <Setter TargetName="bd" Property="Opacity" Value="0.55"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- =========================
         COMBOBOX (FIX: full-width field, no "pill")
         ========================= -->
    <Style TargetType="ComboBox">
        <Setter Property="Background" Value="#101329"/>
        <Setter Property="BorderBrush" Value="{StaticResource StrokeGlow}"/>
        <Setter Property="Foreground" Value="{StaticResource TextStrong}"/>
        <Setter Property="BorderThickness" Value="1"/>
        <Setter Property="Padding" Value="14,10"/>
        <Setter Property="Height" Value="52"/>
        <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
        <Setter Property="VerticalContentAlignment" Value="Center"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="ComboBox">
                    <Grid>
                        <!-- Visual -->
                        <Border x:Name="Bd"
                                CornerRadius="14"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}">
                            <Grid Margin="14,0,14,0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <ContentPresenter x:Name="ContentSite"
                                                  Content="{TemplateBinding SelectionBoxItem}"
                                                  ContentTemplate="{TemplateBinding SelectionBoxItemTemplate}"
                                                  ContentStringFormat="{TemplateBinding SelectionBoxItemStringFormat}"
                                                  HorizontalAlignment="Left"
                                                  VerticalAlignment="Center"
                                                  Margin="0,0,28,0"/>

                                <TextBlock x:Name="Arrow"
                                           Grid.Column="1"
                                           Text="▾"
                                           Foreground="{StaticResource TextDim}"
                                           FontSize="16"
                                           VerticalAlignment="Center"
                                           Margin="10,0,0,0"/>
                            </Grid>
                        </Border>

                        <!-- Click/Toggle слой (растягивается на всю ширину, устраняет “пилюлю”) -->
                        <ToggleButton x:Name="DropDownToggle"
                                      Background="Transparent"
                                      BorderThickness="0"
                                      Focusable="False"
                                      HorizontalContentAlignment="Stretch"
                                      VerticalContentAlignment="Stretch"
                                      IsChecked="{Binding IsDropDownOpen, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}">
                            <ToggleButton.Template>
                                <ControlTemplate TargetType="ToggleButton">
                                    <Border Background="Transparent"/>
                                </ControlTemplate>
                            </ToggleButton.Template>
                        </ToggleButton>

                        <!-- Popup -->
                        <Popup x:Name="PART_Popup"
                               Placement="Bottom"
                               AllowsTransparency="True"
                               Focusable="False"
                               IsOpen="{TemplateBinding IsDropDownOpen}"
                               PopupAnimation="Fade">
                            <Border CornerRadius="14"
                                    Background="#141A36"
                                    BorderBrush="{StaticResource StrokeGlow}"
                                    BorderThickness="1"
                                    Effect="{StaticResource ShadowAccent}"
                                    MinWidth="{Binding ActualWidth, RelativeSource={RelativeSource TemplatedParent}}">
                                <ScrollViewer Margin="6"
                                              SnapsToDevicePixels="True"
                                              VerticalScrollBarVisibility="Auto"
                                              CanContentScroll="True">
                                    <ItemsPresenter/>
                                </ScrollViewer>
                            </Border>
                        </Popup>
                    </Grid>

                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="Bd" Property="Background" Value="#141A36"/>
                        </Trigger>

                        <Trigger Property="IsKeyboardFocusWithin" Value="True">
                            <Setter TargetName="Bd" Property="BorderBrush" Value="{StaticResource Accent2}"/>
                            <Setter TargetName="Bd" Property="Effect" Value="{StaticResource ShadowAccentStrong}"/>
                        </Trigger>

                        <Trigger Property="IsDropDownOpen" Value="True">
                            <Setter TargetName="Bd" Property="Background" Value="#141A36"/>
                            <Setter TargetName="Bd" Property="BorderBrush" Value="{StaticResource Accent2}"/>
                            <Setter TargetName="Arrow" Property="Text" Value="▴"/>
                        </Trigger>

                        <Trigger Property="IsEnabled" Value="False">
                            <Setter TargetName="Bd" Property="Opacity" Value="0.55"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- Items in dropdown -->
    <Style TargetType="ComboBoxItem">
        <Setter Property="Foreground" Value="{StaticResource TextStrong}"/>
        <Setter Property="Padding" Value="12,10"/>
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="ComboBoxItem">
                    <Border x:Name="bd" CornerRadius="10" Background="{TemplateBinding Background}">
                        <ContentPresenter/>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsHighlighted" Value="True">
                            <Setter TargetName="bd" Property="Background" Value="#241A36"/>
                        </Trigger>
                        <Trigger Property="IsSelected" Value="True">
                            <Setter TargetName="bd" Property="Background" Value="#2D2452"/>
                        </Trigger>
                        <Trigger Property="IsEnabled" Value="False">
                            <Setter TargetName="bd" Property="Opacity" Value="0.55"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- =========================
         PROGRESSBAR (FIXED, correct fill)
         ========================= -->
    <Style x:Key="ProgressBarAccurateStyle" TargetType="ProgressBar">
        <Setter Property="Height" Value="10"/>
        <Setter Property="Foreground" Value="{StaticResource Accent2}"/>
        <Setter Property="Background" Value="#26FFFFFF"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="ProgressBar">
                    <Grid SnapsToDevicePixels="True" ClipToBounds="True">
                        <Border CornerRadius="6"
                                Background="{TemplateBinding Background}"/>

                        <Track x:Name="PART_Track"
                               Minimum="{TemplateBinding Minimum}"
                               Maximum="{TemplateBinding Maximum}"
                               Value="{TemplateBinding Value}"
                               IsDirectionReversed="False">
                            <Track.DecreaseRepeatButton>
                                <RepeatButton x:Name="Indicator"
                                              IsHitTestVisible="False"
                                              Focusable="False"
                                              Background="{TemplateBinding Foreground}"
                                              BorderThickness="0"
                                              Opacity="0.95">
                                    <RepeatButton.Template>
                                        <ControlTemplate TargetType="RepeatButton">
                                            <Border CornerRadius="6"
                                                    Background="{TemplateBinding Background}"/>
                                        </ControlTemplate>
                                    </RepeatButton.Template>
                                </RepeatButton>
                            </Track.DecreaseRepeatButton>

                            <Track.Thumb>
                                <Thumb Width="0" IsHitTestVisible="False" Focusable="False"/>
                            </Track.Thumb>

                            <Track.IncreaseRepeatButton>
                                <RepeatButton IsHitTestVisible="False"
                                              Focusable="False"
                                              Background="Transparent"
                                              BorderThickness="0"/>
                            </Track.IncreaseRepeatButton>
                        </Track>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- default ProgressBar uses accurate template -->
    <Style TargetType="ProgressBar" BasedOn="{StaticResource ProgressBarAccurateStyle}"/>

    <!-- logs list item style -->
    <Style x:Key="LogListItemStyle" TargetType="ListBoxItem">
        <Setter Property="Padding" Value="0"/>
        <Setter Property="Margin" Value="0,2"/>
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="BorderThickness" Value="0"/>
        <Setter Property="Focusable" Value="False"/>
        <Setter Property="IsHitTestVisible" Value="False"/>
    </Style>

    <!-- One button: Play OR Stop (НЕ ТРОГАЕМ) -->
    <Style x:Key="PlayOrStopButtonStyle" TargetType="Button" BasedOn="{StaticResource PrimaryButton}">
        <Setter Property="Content" Value="{Binding PlayButtonText}"/>
        <Setter Property="IsEnabled" Value="{Binding CanPlay}"/>
        <Style.Triggers>
            <DataTrigger Binding="{Binding CanStop}" Value="True">
                <Setter Property="Content" Value="Остановить"/>
                <Setter Property="IsEnabled" Value="True"/>
            </DataTrigger>
        </Style.Triggers>
    </Style>

</ResourceDictionary>
